{"version":3,"sources":["meteor://ðŸ’»app/lib/hooks.js"],"names":[],"mappings":"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","file":"/lib/hooks.js","sourcesContent":["var IR_BeforeHooks = {\r\n    isLogin: function(){\r\n        var currentRoute = Iron.Location.get().path;\r\n        if(Meteor.userId() && currentRoute == '/login'){\r\n            Router.go('/');\r\n            this.render('newHome');\r\n            pause();\r\n        }else {\r\n            this.next();\r\n        }\r\n    },\r\n    isAdmin: function() {\r\n        if( ! Meteor.userId() ){\r\n            Router.go('/login');\r\n            this.next()\r\n        }\r\n        else if (!Roles.userIsInRole(Meteor.userId(), ['admin'], 'mygroup')) {\r\n            //Router.go('/notfound');\r\n            //this.next();\r\n            this.render('notfound');\r\n            pause();\r\n        } else {\r\n            this.next();\r\n        }\r\n    },\r\n    isAdminOrMember: function() {\r\n        if( ! Meteor.userId() ){\r\n            // this.render('login');\r\n            Router.go('/login');\r\n            this.next();\r\n        }\r\n        else if (!Roles.userIsInRole(Meteor.userId(), ['admin', 'member'], 'mygroup')) {\r\n            //Router.go('/notfound');\r\n            //this.next();\r\n            this.render('notfound');\r\n            pause();\r\n        } else {\r\n            this.next();\r\n        }\r\n    },\r\n    checkoutNotLogin: function() {\r\n        if (!Roles.userIsInRole(Meteor.userId(), ['admin', 'member'], 'mygroup')) {\r\n            this.render('login');\r\n            \r\n        } else {\r\n            this.next();\r\n        }\r\n    },\r\n    trackingRouter: function() {\r\n        if (Meteor.isClient) {\r\n            if (Meteor.userId() != null)\r\n                userId = Meteor.userId();\r\n            else\r\n                userId = Session.get('userId');\r\n            var time = Date.now();\r\n            var currenturl = window.location.href;\r\n            Meteor.call('trackingRouter', userId, time, currenturl);\r\n            //this.next();\r\n        }\r\n    },\r\n    pageView: function() {\r\n        if (Meteor.isClient) {\r\n            var admin_url = Router.current().url;\r\n            var result = admin_url.split('/')[1];\r\n            if (result==\"\")\r\n                result = \"home\";\r\n            var url = 'https://www.google-analytics.com/collect?v=1&t=pageview&tid=UA-71059459-2&cid=555&dh=' + admin_url + '&dp=%2F' + result + '&dt=' + result + 'page';\r\n            Meteor.call('eventCall', url, function(error, result) {\r\n                if (error) {\r\n                    console.log('Analytic CLIENT ERRR');\r\n                    console.log(error);\r\n                } else {\r\n                    console.log('Analytic CLIENT RESULT');\r\n                    console.log(result);\r\n                }\r\n            });\r\n            \r\n        }\r\n        this.next();\r\n    }\r\n\r\n};\r\n\r\nvar routerNameLogin = [\r\n    'login'\r\n];\r\n\r\nvar routerNameAdmin = [\r\n    'managerole',\r\n    'userlist',\r\n    'managepost',\r\n    'homeadmin',\r\n    'addpost',\r\n    'category',\r\n    'managecategory',\r\n    'manageslider',\r\n    'addslider'\r\n\r\n    \r\n];\r\nvar routerNameMember = [\r\n    'profile',\r\n    'editprofile',\r\n    'reward',\r\n    'member',\r\n    'dailyPopup',\r\n    'confirmorder',\r\n    'confirmorder1',\r\n    'confirmorder2',\r\n    'payment',\r\n    'afterregisterStepOne',\r\n    'afterregisterStepTwo',\r\n    'afterregisterStepThree',\r\n    'afterregisterStepFour',\r\n    'afterregisterStepFive'\r\n\r\n];\r\nvar routerCheckout = ['checkout'];\r\nvar routerLogin = ['login'];\r\n//Router.before(IR_BeforeHooks.pageView);\r\nRouter.before(IR_BeforeHooks.isAdmin, { only: routerNameAdmin });\r\nRouter.before(IR_BeforeHooks.isAdminOrMember, { only: routerNameMember }); //for member\r\n//Router.onAfterAction(IR_BeforeHooks.trackingRouter);\r\n//Router.onBeforeAction(IR_BeforeHooks.checkLogin, {only: routerLogin});\r\n// Router.onAfterAction(IR_BeforeHooks.sitemap);\r\n//Router.onAfterAction(IR_BeforeHooks.updateMembershipId);\r\n\r\n\r\n//Router.onBeforeAction(IR_BeforeHooks.MySubscription);\r\n//Router.onBeforeAction(IR_BeforeHooks.checkoutNotLogin,{only:routerCheckout});\r\nRouter.before(IR_BeforeHooks.isLogin, { only: routerNameLogin });\r\n"]}